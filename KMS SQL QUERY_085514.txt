create database [Kulttra Mega Stores Inventory]


---1---Which product category had the highest sales
SELECT TOP 1 Product_Category, SUM(Sales) AS Total_Sales
FROM [KMS Sql Case Study]
GROUP BY Product_Category
ORDER BY Total_Sales DESC

--2--Top 3 and Bottom 3 regions in terms of sales

-- Top 3 Regions
SELECT top 3 Region, SUM(Sales) AS Total_Sales
FROM [KMS Sql Case Study]
GROUP BY Region
ORDER BY Total_Sales DESC


-- Top 3 Regions
SELECT top 3 Region, SUM(Sales) AS Total_Sales
FROM [KMS Sql Case Study]
GROUP BY Region
ORDER BY Total_Sales ASC


---3--Total sales of appliances in Ontario
SELECT Region, SUM(Sales) AS [Total Sales of Appliance]
FROM [KMS Sql Case Study]
WHERE Province = 'Ontario'
And Product_Sub_Category ='Appliances'
group by Region 


---4--Advice on Bottom 10 Customers (by revenue)


SELECT top 10 Customer_Name, SUM(Sales) AS Total_Sales
FROM [KMS Sql Case Study]
GROUP BY Customer_Name
ORDER BY Total_Sales ASC

---5---Shipping method with highest shipping cost

SELECT Ship_Mode, SUM(Shipping_Cost) AS Total_Shipping_Cost
FROM [KMS Sql Case Study]
GROUP BY Ship_Mode
ORDER BY Total_Shipping_Cost DESC


Case Scenario II
--6--Most valuable customers and what products or services do they typically purchase
SELECT Customer_Name, SUM(Sales) AS Total_Sales, Product_Category
FROM [KMS Sql Case Study]
GROUP BY Product_Category, Customer_Name
ORDER BY Total_Sales DESC

---7----which Small Business customer had the highest sales-----

SELECT Customer_Name, Sales from [KMS Sql Case Study]
where Customer_Segment = 



---8--- Which corporate customer placed the most number of ordersin 2009-2012



----9---Which customer was the most profitable one

SELECT Top 1 Customer_Name, Sum(profit) as Total_Profit from [KMS Sql Case Study]
where customer_segment = 'Consumer'
group by customer_Name
order by [Total_Profit] Desc

----union-----
select * from dbo.[KMS Sql Case Study] KMS
Join Order_Status OS
on KMS.Order_ID = OS.Order_ID

---10--- Which Customer returned items and what segment do they return do they belong to

---11---- IF the delivery truck is the most economical but the slowest shipping method and express air is the fastest 

----shipping cost breakdown by priority
select order_priority, ship_mode, sum(shipping_cost) as total_shipping_cost from [KMS Sql Case Study]
group by Order_Priority, Ship_Mode
order by Order_Priority, total_shipping_cost desc

---order count by shipping method and priority
select order_priority, ship_mode, count(*) as order_count from [KMS Sql Case Study]
group by Order_Priority, Ship_Mode
order by Order_Priority, order_count desc